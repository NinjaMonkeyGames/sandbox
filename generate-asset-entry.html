<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Markdown Asset Document Generator</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background-color: #f4f4f9; }
        .container { max-width: 900px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #333; }
        h2 { border-bottom: 2px solid #ccc; padding-bottom: 5px; color: #555; }
        label { display: block; margin-top: 10px; font-weight: bold; }
        input[type="text"], textarea, select { width: 100%; padding: 8px; margin-top: 5px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        .form-group { margin-bottom: 15px; }
        
        /* Button Styles */
        .button-group { display: flex; gap: 10px; margin-top: 20px; }
        .button-group button { padding: 10px 15px; border: none; border-radius: 4px; cursor: pointer; color: white; transition: background-color 0.3s; }
        
        /* Copy Button */
        #copyButton { background-color: #28a745; }
        #copyButton:hover:not(:disabled) { background-color: #1e7e34; }
        
        /* Disabled State */
        .button-group button:disabled { background-color: #ccc; cursor: not-allowed; }

        /* Output Box */
        #output { background-color: #eee; padding: 15px; border-radius: 4px; white-space: pre-wrap; margin-top: 20px; border: 1px solid #ccc; min-height: 100px; }
    </style>
</head>
<body>

<div class="container">
    <h1>Advanced Markdown Asset Document Generator</h1>

    <form id="generatorForm" oninput="checkFormValidity()">
        <h2>Input Variables</h2>
        <div class="form-group">
            <label for="assetTitle">Main Title Text (Force Uppercase):</label>
            <input type="text" id="assetTitle" required value="">
        </div>

        <div class="form-group">
            <label for="assetName">Asset Name (e.g., .git):</label>
            <input type="text" id="assetName" required value="">
        </div>

        <div class="form-group">
            <label for="relativePath">Relative Path (Force Lowercase & Forward Slashes):</label>
            <input type="text" id="relativePath" required value="">
        </div>

        <div class="form-group">
            <label for="includeInRepo">Include in Repository:</label>
            <select id="includeInRepo">
                <option value="Yes">Yes</option>
                <option value="No" selected>No</option>
            </select>
        </div>

        <div class="form-group">
            <label for="assetType">Asset Type (Influences Emoji):</label>
            <select id="assetType">
                <option value="FOLDER" selected>FOLDER</option>
                <option value="FILE">FILE</option>
            </select>
        </div>
        
        <div class="form-group">
            <label for="ciType">CI Type (Conventional Commit Type):</label>
            <select id="ciType">
                <option value="N/A" selected>N/A</option>
                <option value="feat">feat (New feature)</option>     
                <option value="fix">fix (Bug fix)</option>      
                <option value="docs">docs (Documentation changes)</option>     
                <option value="style">style (Code style changes, no code change)</option>    
                <option value="refactor">refactor (Refactor without new features or fixes)</option> 
                <option value="perf">perf (Performance improvements)</option>     
                <option value="test">test (Adding or updating tests)</option>     
                <option value="build">build (Changes to build system or dependencies)</option>    
                <option value="ci">ci (Continuous integration-related changes)</option>       
                <option value="chore">chore (Other changes that don't modify source or test files)</option>    
                <option value="revert">revert (Reverts a previous commit)</option>   
            </select>
        </div>

        <div class="form-group">
            <label for="ciScope">CI Scope (System Area):</label>
            <select id="ciScope">
                <option value="N/A" selected>N/A</option>
                <option value="core">core (For core changes)</option>     
                <option value="api">api (For API-related changes)</option>      
                <option value="ui">ui (For UI-related changes)</option>       
                <option value="auth">auth (For authentication changes)</option>     
                <option value="db">db (For database changes)</option>       
                <option value="deps">deps (For dependency updates)</option>     
                <option value="tests">tests (For test-related changes)</option>    
                <option value="config">config (For configuration updates)</option>   
                <option value="security">security (For security-related changes)</option> 
                <option value="rebase">rebase (For rebase-related changes)</option>   
            </select>
        </div>

        <div class="form-group">
            <label for="fileFormat">File Format (If Asset Type is FILE):</label>
            <select id="fileFormat">
                <option value="N/A" selected>N/A</option>
                <option value="TEXT">TEXT</option>
                <option value="YAML">YAML</option>
                <option value="PNG">PNG</option>
                <option value="JSON">JSON</option>
                <option value="TOML">TOML</option>
                <option value="YOYO Configuration File">YOYO Configuration File</option>
            </select>
        </div>

        <div class="form-group">
            <label for="assetPurpose">Asset Purpose Description:</label>
            <textarea id="assetPurpose" required></textarea>
        </div>

        <div class="form-group">
            <label for="assetContents">Asset Contents Description:</label>
            <textarea id="assetContents" required></textarea>
        </div>

        <div class="button-group">
             <button type="button" id="copyButton" onclick="copyToClipboard()" disabled>Copy to Clipboard</button>
        </div>
    </form>

    <h2>Generated Output (Markdown)</h2>
    <div id="output">Fill in all required fields to generate content.</div>
</div>

<script>
    const fixedBackToTopTarget = '#grid-utility-project-programmers-manual';
    const requiredFields = ['assetTitle', 'assetName', 'relativePath', 'assetPurpose', 'assetContents'];
    
    // Function to check if all required fields are populated
    function checkFormValidity() {
        const isFormValid = requiredFields.every(id => document.getElementById(id).value.trim() !== '');
        
        const copyButton = document.getElementById('copyButton');
        
        // If the form is valid, generate the markdown and enable the copy button
        if (isFormValid) {
            generateMarkdown();
            copyButton.disabled = false;
        } else {
            // If not valid, clear output and disable copy button
            document.getElementById('output').textContent = 'Fill in all required fields to generate content.';
            copyButton.disabled = true;
        }
    }

    function copyToClipboard() {
        const outputText = document.getElementById('output').textContent;
        navigator.clipboard.writeText(outputText).then(() => {
            // Provide visual feedback
            const copyButton = document.getElementById('copyButton');
            const originalText = copyButton.textContent;
            copyButton.textContent = 'Copied!';
            setTimeout(() => {
                copyButton.textContent = originalText;
            }, 1500);
        }).catch(err => {
            console.error('Could not copy text: ', err);
            alert('Copy failed. Please manually copy the text from the box.');
        });
    }

    function generateMarkdown() {
        // This function is only called when the form is valid, per checkFormValidity()
        
        // 1. Get values from input fields and apply forced casing/formatting
        const assetTitle = document.getElementById('assetTitle').value.trim().toUpperCase(); // Force Uppercase
        const assetName = document.getElementById('assetName').value.trim();
        
        let relativePath = document.getElementById('relativePath').value.trim().toLowerCase(); // Force Lowercase
        // Force forward slashes: replace all backslashes with forward slashes
        relativePath = relativePath.replace(/\\/g, '/');
        
        // 2. Get values from dropdowns
        const includeInRepo = document.getElementById('includeInRepo').value;
        const assetType = document.getElementById('assetType').value;
        const ciType = document.getElementById('ciType').value;
        const ciScope = document.getElementById('ciScope').value;
        const fileFormat = document.getElementById('fileFormat').value;

        // 3. Get text area values
        const assetPurpose = document.getElementById('assetPurpose').value.trim();
        const assetContents = document.getElementById('assetContents').value.trim();
        
        // 4. Determine the correct Asset Type value for the table and the emoji
        const finalAssetTypeValue = assetType === 'FILE' ? `${assetType} (${fileFormat})` : assetType;
        const emoji = assetType === 'FOLDER' ? 'üìÅ' : 'üìÑ'; // Folder icon or File icon

        // 5. Construct the MD060 Compliant Markdown output string (Note the required padding: | Attribute | Value |)
        const markdownOutput = 
`### ${assetTitle} [${assetName.toUpperCase()}] ${emoji}

#### Attribute Table ‚Äî [${assetName}]

| Attribute | Value |
| :--- | :--- |
| Asset Name | ${assetName} |
| Relative Path | ${relativePath} |
| Include in Repository | ${includeInRepo} |
| Asset Type | ${finalAssetTypeValue} |
| CI Type | ${ciType} |
| CI Scope | ${ciScope} |

#### Asset Purpose ‚Äî [${assetName}]

${assetPurpose}

#### Asset Contents Description ‚Äî [${assetName}]

${assetContents}

---

[Back to top](${fixedBackToTopTarget})

---`;

        // 6. Display the output
        document.getElementById('output').textContent = markdownOutput;
    }
</script>

</body>
</html>