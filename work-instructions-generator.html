<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NMG Sentence-Builder Generator</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #f4f4f9; color: #333; }
        #generator { background-color: #fff; padding: 25px; border-radius: 8px; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); max-width: 1200px; margin: auto; }
        
        #controls-container { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
        .section-box { padding: 15px; border: 1px solid #ddd; border-radius: 6px; background-color: #fbfbfb; }
        h2 { margin-top: 0; font-size: 1.2em; border-bottom: 2px solid #eee; padding-bottom: 8px; }

        /* Sentence Builder Styling */
        .sentence-row { 
            background: white; 
            padding: 12px; 
            border: 1px solid #eee; 
            border-radius: 4px; 
            margin-bottom: 12px; 
            line-height: 2;
            display: block;
        }
        .sentence-row label { font-weight: bold; color: #555; display: block; margin-bottom: 5px; text-transform: uppercase; font-size: 0.75em; }
        
        input[type="text"], select, textarea { 
            padding: 6px; border: 1px solid #ccc; border-radius: 3px; font-size: 0.95em;
        }
        .sentence-row input[type="text"] { width: auto; min-width: 100px; border-top: none; border-left: none; border-right: none; border-radius: 0; background: #fffcf0; }
        
        button { padding: 6px 14px; background-color: #5cb85c; color: white; border: none; border-radius: 4px; cursor: pointer; transition: 0.2s; font-weight: bold; }
        button:hover { background-color: #4cae4c; }
        .btn-add { margin-top: 10px; display: block; }

        /* Output Styling */
        #output-area { margin-top: 30px; padding: 20px; border: 2px dashed #007bff; background-color: #f0f7ff; border-radius: 6px; }
        #output-list { list-style: none; padding: 0; }
        #output-list li { display: flex; align-items: flex-start; margin-bottom: 8px; font-size: 1.05em; line-height: 1.5; }
        
        .instruction-number { font-weight: bold; margin-right: 12px; color: #007bff; min-width: 25px; }
        .instruction-content { flex-grow: 1; }
        
        /* Blocks */
        .heading-block { display: block !important; margin: 25px 0 10px 0 !important; border-bottom: 1px solid #333; }
        .heading-title { font-weight: bold; font-size: 1.2em; }
        .heading-description { display: block; font-weight: normal; font-size: 0.9em; color: #666; margin: 5px 0; }
        .text-block { background: #eee; padding: 8px; border-radius: 4px; margin: 10px 0 !important; }

        /* Formatting in output */
        .control-output { font-weight: bold; font-family: monospace; background: #e8e8e8; padding: 2px 4px; border-radius: 3px; }
        .value-output { font-weight: bold; font-style: italic; color: #2c3e50; }
        .link-output { color: #0056b3; font-family: monospace; }

        .action-buttons { margin-left: 15px; opacity: 0.5; transition: 0.3s; }
        .action-buttons:hover { opacity: 1; }
        .action-buttons button { padding: 2px 6px; font-size: 0.8em; background: #999; }
        .del-btn { background: #d9534f !important; }
    </style>
</head>
<body>

<div id="generator">
    <h1>NMG Sentence-Builder Instruction Generator</h1>

    <div id="controls-container">
        <div class="section-box">
            <h2>1. Document Structure</h2>
            
            <div class="sentence-row">
                <label>Heading Block</label>
                <select id="headingLevel"><option value="h2">H2</option><option value="h3">H3</option></select>
                Title: <input type="text" id="headingTitle" placeholder="e.g. Configuration">
                Description: <input type="text" id="headingDescription" style="width: 200px;" placeholder="Optional context...">
                <button onclick="generateHeadingBlock()" class="btn-add">Add Heading (Resets List)</button>
            </div>

            <div class="sentence-row">
                <label>Alert Block</label>
                Type: <select id="blockType"><option value="info">‚ÑπÔ∏è Info</option><option value="pro-tip">üí° Tip</option><option value="caution">‚ö†Ô∏è Caution</option></select>
                Content: <input type="text" id="blockContent" style="width: 250px;">
                <button onclick="generateTextBlock()" class="btn-add">Add Alert</button>
            </div>

            <div class="sentence-row">
                <label>Plain Text Step</label>
                Text: <input type="text" id="plainTextContent" style="width: 300px;" placeholder="Describe a manual step...">
                <button onclick="generatePlainTextLine()" class="btn-add">Add Numbered Step</button>
            </div>
        </div>

        <div class="section-box">
            <h2>2. Step Creation (Sentence Builder)</h2>

            <div class="sentence-row">
                <label>Click Action</label>
                Click <input type="text" id="clickLabel" placeholder="Button Name">.
                <button onclick="generateClickInstruction()" class="btn-add">Add Step</button>
            </div>

            <div class="sentence-row">
                <label>Enter Value</label>
                Select <input type="text" id="enterFieldLabel" placeholder="Field Label"> and type 
                <input type="checkbox" id="useQuotes" checked> " <input type="text" id="enterValue" placeholder="Value"> ".
                <button onclick="generateEnterInstruction()" class="btn-add">Add Step</button>
            </div>

            <div class="sentence-row">
                <label>Dropdown/Set Value</label>
                Click <input type="text" id="setClickLabel" placeholder="e.g. base: master"> then Select 
                <input type="text" id="setSelectValue" placeholder="e.g. develop"> from the drop-down box.
                <button onclick="generateSetInstruction()" class="btn-add">Add Step</button>
            </div>

            <div class="sentence-row">
                <label>Check/Uncheck</label>
                <select id="checkAction">
                    <option value="Check">[x] Check</option>
                    <option value="Ensure the following options are unchecked">[ ] Uncheck</option>
                </select>
                <input type="text" id="checkLabel" placeholder="Option name">.
                <button onclick="generateCheckInstruction()" class="btn-add">Add Step</button>
            </div>

            <div class="sentence-row">
                <label>Go To Link</label>
                Go to <input type="text" id="goToLink" placeholder="URL or link name">.
                <button onclick="generateGoToInstruction()" class="btn-add">Add Step</button>
            </div>
        </div>
    </div>

    <div id="output-area">
        <h2>Live Preview</h2>
        <ul id="output-list"></ul>
        <div style="margin-top: 20px;">
            <button onclick="clearInstructions()" style="background: #666;">Clear All</button>
            <button id="copy-button" onclick="copyToMarkdown()" style="background: #007bff; padding: 10px 20px;">Copy Markdown to Clipboard</button>
        </div>
    </div>
</div>

<script>
    const outputList = document.getElementById('output-list');

    function updateInstructionNumbers() {
        let counter = 1;
        for (let item of outputList.children) {
            const numSpan = item.querySelector('.instruction-number');
            if (item.classList.contains('heading-block')) {
                counter = 1; // RESET ON HEADING
                numSpan.textContent = '';
            } else if (item.classList.contains('text-block')) {
                numSpan.textContent = '';
            } else {
                numSpan.textContent = `${counter}.`;
                counter++;
            }
        }
    }

    function addInstruction(html, prefixHTML, isBlock = false, blockClass = '') {
        const li = document.createElement('li');
        if (isBlock) li.classList.add(blockClass);
        li.innerHTML = `
            <span class="instruction-number"></span>
            ${prefixHTML ? `<span style="margin-right:8px">${prefixHTML}</span>` : ''}
            <span class="instruction-content">${html}</span>
            <span class="action-buttons">
                <button onclick="move(this, -1)">‚ñ≤</button>
                <button onclick="move(this, 1)">‚ñº</button>
                <button class="del-btn" onclick="del(this)">‚úï</button>
            </span>
        `;
        outputList.appendChild(li);
        updateInstructionNumbers();
    }

    // Handlers
    function generateHeadingBlock() {
        const t = document.getElementById('headingTitle').value.trim();
        const d = document.getElementById('headingDescription').value.trim();
        const lvl = document.getElementById('headingLevel').value === 'h2' ? '##' : '###';
        if (t) {
            addInstruction(`<span class="heading-title">${lvl} ${t}</span>${d ? `<span class="heading-description">${d}</span>` : ''}`, null, true, 'heading-block');
            document.getElementById('headingTitle').value = ''; document.getElementById('headingDescription').value = '';
        }
    }

    function generateClickInstruction() {
        const l = document.getElementById('clickLabel').value.trim();
        if (l) { addInstruction(`Click <span class="control-output">\`${l}\`</span>.`, null); document.getElementById('clickLabel').value = ''; }
    }

    function generateEnterInstruction() {
        const f = document.getElementById('enterFieldLabel').value.trim();
        const v = document.getElementById('enterValue').value.trim();
        const q = document.getElementById('useQuotes').checked ? '‚Äú' : '';
        if (f && v) {
            addInstruction(`Select <span class="control-output">\`${f}\`</span> and type <span class="value-output">${q}${v}${q?'‚Äù':''}</span>.`, null);
            document.getElementById('enterFieldLabel').value = ''; document.getElementById('enterValue').value = '';
        }
    }

    function generateSetInstruction() {
        const c = document.getElementById('setClickLabel').value.trim();
        const s = document.getElementById('setSelectValue').value.trim();
        if (c && s) {
            addInstruction(`Click <span class="control-output">\`${c}\`</span> then Select <span class="control-output">\`${s}\`</span> from the drop-down box.`, null);
            document.getElementById('setClickLabel').value = ''; document.getElementById('setSelectValue').value = '';
        }
    }

    function generateCheckInstruction() {
        const a = document.getElementById('checkAction').value;
        const l = document.getElementById('checkLabel').value.trim();
        if (l) { addInstruction(`<span class="value-output">${a}</span> <span class="control-output">\`${l}\`</span>.`, null); document.getElementById('checkLabel').value = ''; }
    }

    function generateGoToInstruction() {
        const l = document.getElementById('goToLink').value.trim();
        if (l) { addInstruction(`Go to <span class="link-output">&lt;${l}&gt;</span>.`, null); document.getElementById('goToLink').value = ''; }
    }

    function generatePlainTextLine() {
        const c = document.getElementById('plainTextContent').value.trim();
        if (c) { addInstruction(c, null); document.getElementById('plainTextContent').value = ''; }
    }

    function generateTextBlock() {
        const c = document.getElementById('blockContent').value.trim();
        const e = document.getElementById('blockType').value === 'info' ? '‚ÑπÔ∏è' : 'üí°';
        if (c) { addInstruction(`<span style="font-style:italic">${c}</span>`, e, true, 'text-block'); document.getElementById('blockContent').value = ''; }
    }

    function del(btn) { btn.closest('li').remove(); updateInstructionNumbers(); }
    function move(btn, dir) {
        const li = btn.closest('li');
        if (dir === -1 && li.previousElementSibling) li.parentNode.insertBefore(li, li.previousElementSibling);
        else if (dir === 1 && li.nextElementSibling) li.parentNode.insertBefore(li.nextElementSibling, li);
        updateInstructionNumbers();
    }
    function clearInstructions() { outputList.innerHTML = ''; }

    function copyToMarkdown() {
        let md = "";
        let steps = 1;
        for (let li of outputList.children) {
            const content = li.querySelector('.instruction-content');
            if (li.classList.contains('heading-block')) {
                const title = li.querySelector('.heading-title').textContent;
                const desc = li.querySelector('.heading-description')?.textContent;
                md += `\n${title}\n${desc ? '\n' + desc + '\n' : ''}\n---\n`;
                steps = 1;
            } else if (li.classList.contains('text-block')) {
                const emoji = li.querySelector('span:nth-child(2)').textContent;
                md += `\n> ${emoji} **${content.textContent.trim()}**\n`;
            } else {
                let txt = content.innerHTML
                    .replace(/<span class="control-output">`([^`]+)`<\/span>/g, '`$1`')
                    .replace(/<span class="value-output">‚Äú?([^‚Äù<]+)‚Äù?<\/span>/g, '**$1**')
                    .replace(/<span class="link-output">&lt;([^&]+)&gt;<\/span>/g, '<$1>')
                    .replace(/<[^>]*>?/gm, '').trim();
                md += `${steps}. ${txt}\n`;
                steps++;
            }
        }
        navigator.clipboard.writeText(md);
        const btn = document.getElementById('copy-button');
        btn.textContent = "Copied!";
        setTimeout(() => btn.textContent = "Copy Markdown to Clipboard", 1500);
    }
</script>

</body>
</html>